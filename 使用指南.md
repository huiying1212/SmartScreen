# å®‰å“ç”¨æˆ·è¡Œä¸ºæ•°æ®æ”¶é›†å™¨ä½¿ç”¨æŒ‡å—

## ğŸ“‹ **å‰ç½®è¦æ±‚**

### ç³»ç»Ÿè¦æ±‚
- Android 6.0 (API 23) åŠä»¥ä¸Š
- æ”¯æŒè“ç‰™4.0+ã€GPSå®šä½
- åŠ é€Ÿåº¦è®¡å’Œé™€èºä»ªä¼ æ„Ÿå™¨
- è‡³å°‘200MBå¯ç”¨å­˜å‚¨ç©ºé—´

### å¼€å‘ç¯å¢ƒ
- Android Studio 4.0+
- Gradle 6.0+
- Java 8+

## ğŸ›  **å®‰è£…éƒ¨ç½²**

### 1. é¡¹ç›®å¯¼å…¥
```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®æ–‡ä»¶
# åœ¨Android Studioä¸­æ‰“å¼€é¡¹ç›®
File â†’ Open â†’ é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹
```

### 2. ä¾èµ–é…ç½®
åœ¨`app/build.gradle`ä¸­æ·»åŠ ï¼š
```gradle
dependencies {
    implementation 'androidx.core:core:1.8.0'
    implementation 'org.json:json:20210307'
    // å…¶ä»–å¿…è¦ä¾èµ–å·²åœ¨ä»£ç ä¸­å£°æ˜
}
```

### 3. ç¼–è¯‘å®‰è£…
```bash
# è¿æ¥å®‰å“è®¾å¤‡æˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
# ç¼–è¯‘å¹¶å®‰è£…åº”ç”¨
./gradlew installDebug
```

## ğŸ¯ **ä½¿ç”¨æ–¹æ³•**

### æ–¹æ³•ä¸€ï¼šå®Œæ•´é›†æˆä½¿ç”¨

```java
public class MainActivity extends AppCompatActivity {
    private AndroidDataCollector collector;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        
        // 1. åˆ›å»ºæ•°æ®æ”¶é›†å™¨å®ä¾‹
        collector = new AndroidDataCollector();
        
        // 2. å¼€å§‹æ•°æ®æ”¶é›†
        startDataCollection();
    }
    
    private void startDataCollection() {
        // è·å–å®Œæ•´ä¸Šä¸‹æ–‡æ•°æ®
        JSONObject contextData = collector.getCompleteContextData();
        
        // å¤„ç†æ”¶é›†åˆ°çš„æ•°æ®
        processCollectedData(contextData);
    }
    
    private void processCollectedData(JSONObject data) {
        try {
            // æå–å„ç§æ•°æ®ç±»å‹
            long timestamp = data.getLong("timestamp");
            String dateTime = data.getString("date_time");
            
            JSONObject location = data.getJSONObject("location");
            double latitude = location.getDouble("latitude");
            double longitude = location.getDouble("longitude");
            
            JSONObject activity = data.getJSONObject("activity");
            String activityType = activity.getString("activity");
            float confidence = activity.getFloat("confidence");
            
            // ä½¿ç”¨æ•°æ®è¿›è¡Œåç»­å¤„ç†
            Log.d("DataCollector", "ä½ç½®: " + latitude + ", " + longitude);
            Log.d("DataCollector", "æ´»åŠ¨: " + activityType + " (ç½®ä¿¡åº¦: " + confidence + ")");
            
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }
}
```

### æ–¹æ³•äºŒï¼šæ¨¡å—åŒ–ä½¿ç”¨

```java
// ä»…ä½¿ç”¨æ´»åŠ¨è¯†åˆ«
ActivityRecognizer activityRecognizer = new ActivityRecognizer(this);
JSONObject activityInfo = activityRecognizer.getActivityInfo();

// ä»…ä½¿ç”¨å±å¹•å†…å®¹æ”¶é›†
ScreenContentCollector screenCollector = new ScreenContentCollector(this);
screenCollector.startCollection();
JSONArray screenContent = screenCollector.getRecentScreenContent();
```

## âš™ï¸ **æƒé™é…ç½®**

### 1. åŸºæœ¬æƒé™è‡ªåŠ¨ç”³è¯·
åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ç”³è¯·ä»¥ä¸‹æƒé™ï¼š
- ä½ç½®æƒé™ (ACCESS_FINE_LOCATION)
- å­˜å‚¨æƒé™ (WRITE_EXTERNAL_STORAGE)
- è“ç‰™æƒé™ (BLUETOOTH)
- æ—¥å†æƒé™ (READ_CALENDAR)

### 2. æ‰‹åŠ¨å¯ç”¨æ— éšœç¢æœåŠ¡
å±å¹•å†…å®¹æ”¶é›†éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¯ç”¨ï¼š

```
è®¾ç½® â†’ è¾…åŠ©åŠŸèƒ½ â†’ å·²å®‰è£…çš„æœåŠ¡ â†’ 
æ‰¾åˆ°"æ•°æ®æ”¶é›†å™¨" â†’ å¼€å¯æœåŠ¡
```

### 3. ç”µæ± ä¼˜åŒ–è®¾ç½®
ä¸ºç¡®ä¿åå°æ­£å¸¸è¿è¡Œï¼š

```
è®¾ç½® â†’ ç”µæ±  â†’ ç”µæ± ä¼˜åŒ– â†’ 
æ‰¾åˆ°åº”ç”¨ â†’ è®¾ç½®ä¸º"ä¸ä¼˜åŒ–"
```

## ğŸ“Š **æ•°æ®è®¿é—®**

### å®æ—¶æ•°æ®è·å–
```java
// è·å–å½“å‰å®Œæ•´ä¸Šä¸‹æ–‡
JSONObject currentContext = collector.getCompleteContextData();

// è·å–ç‰¹å®šæ—¶é—´èŒƒå›´çš„å±å¹•å†…å®¹
long startTime = System.currentTimeMillis() - 3600000; // 1å°æ—¶å‰
long endTime = System.currentTimeMillis();
JSONArray screenData = screenCollector.getScreenContentInTimeRange(startTime, endTime);
```

### æ–‡ä»¶æ•°æ®è¯»å–
```java
// æ•°æ®è‡ªåŠ¨ä¿å­˜åˆ°å¤–éƒ¨å­˜å‚¨
File dataDir = getExternalFilesDir(null);
File[] dataFiles = dataDir.listFiles((dir, name) -> name.startsWith("context_data_"));

for (File file : dataFiles) {
    try {
        String jsonContent = readFileContent(file);
        JSONObject data = new JSONObject(jsonContent);
        // å¤„ç†å†å²æ•°æ®
    } catch (Exception e) {
        e.printStackTrace();
    }
}
```

## ğŸ”„ **å®šæ—¶æ•°æ®æ”¶é›†**

### è®¾ç½®è‡ªåŠ¨æ”¶é›†
```java
public class AutoDataCollector {
    private Timer timer;
    private AndroidDataCollector collector;
    
    public void startPeriodicCollection(int intervalMinutes) {
        timer = new Timer();
        timer.scheduleAtFixedRate(new TimerTask() {
            @Override
            public void run() {
                JSONObject data = collector.getCompleteContextData();
                saveDataToDatabase(data); // ä¿å­˜åˆ°æ•°æ®åº“
                uploadDataToServer(data); // ä¸Šä¼ åˆ°æœåŠ¡å™¨
            }
        }, 0, intervalMinutes * 60 * 1000);
    }
    
    public void stopCollection() {
        if (timer != null) {
            timer.cancel();
        }
    }
}
```

## ğŸ” **æ•°æ®åˆ†æç¤ºä¾‹**

### æ´»åŠ¨æ¨¡å¼åˆ†æ
```java
public class ActivityAnalyzer {
    public void analyzeUserActivity(List<JSONObject> contextData) {
        Map<String, Integer> activityCount = new HashMap<>();
        
        for (JSONObject data : contextData) {
            try {
                JSONObject activity = data.getJSONObject("activity");
                String activityType = activity.getString("activity");
                activityCount.put(activityType, 
                    activityCount.getOrDefault(activityType, 0) + 1);
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
        
        // è¾“å‡ºæ´»åŠ¨ç»Ÿè®¡
        for (Map.Entry<String, Integer> entry : activityCount.entrySet()) {
            Log.d("Analysis", "æ´»åŠ¨: " + entry.getKey() + ", æ¬¡æ•°: " + entry.getValue());
        }
    }
}
```

### ä½ç½®è½¨è¿¹åˆ†æ
```java
public class LocationAnalyzer {
    public void analyzeLocationPattern(List<JSONObject> contextData) {
        List<LatLng> locations = new ArrayList<>();
        
        for (JSONObject data : contextData) {
            try {
                JSONObject location = data.getJSONObject("location");
                double lat = location.getDouble("latitude");
                double lng = location.getDouble("longitude");
                locations.add(new LatLng(lat, lng));
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
        
        // è®¡ç®—ç§»åŠ¨è·ç¦»ã€å¸¸ç”¨åœ°ç‚¹ç­‰
        analyzeMovementPatterns(locations);
    }
}
```

## ğŸ›¡ï¸ **éšç§å’Œå®‰å…¨**

### æ•°æ®æœ¬åœ°åŒ–
```java
// ç¡®ä¿æ•°æ®åªåœ¨æœ¬åœ°å¤„ç†
public class PrivacyManager {
    public static void enablePrivacyMode(AndroidDataCollector collector) {
        // ç¦ç”¨ç½‘ç»œä¸Šä¼ 
        // å¯ç”¨æ•°æ®è„±æ•
        // å®šæœŸæ¸…ç†å†å²æ•°æ®
    }
    
    public static void anonymizeData(JSONObject data) {
        try {
            // ç§»é™¤ç²¾ç¡®ä½ç½®ä¿¡æ¯ï¼Œåªä¿ç•™å¤§è‡´åŒºåŸŸ
            JSONObject location = data.getJSONObject("location");
            location.remove("latitude");
            location.remove("longitude");
            
            // è„±æ•å±å¹•å†…å®¹
            JSONArray screenContent = data.getJSONArray("screen_content");
            for (int i = 0; i < screenContent.length(); i++) {
                JSONObject screen = screenContent.getJSONObject(i);
                String content = screen.getString("content");
                screen.put("content", maskSensitiveInfo(content));
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }
}
```

## ğŸ› **å¸¸è§é—®é¢˜**

### 1. æƒé™è¢«æ‹’ç»
```java
@Override
public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {
    if (requestCode == LOCATION_PERMISSION_REQUEST) {
        if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
            // æƒé™è·å¾—ï¼Œç»§ç»­æ“ä½œ
            startDataCollection();
        } else {
            // æƒé™è¢«æ‹’ç»ï¼Œæ˜¾ç¤ºè¯´æ˜
            showPermissionExplanation();
        }
    }
}
```

### 2. å±å¹•å†…å®¹æ”¶é›†å¤±è´¥
- æ£€æŸ¥æ— éšœç¢æœåŠ¡æ˜¯å¦å¯ç”¨
- ç¡®è®¤åº”ç”¨æœ‰è¶³å¤Ÿçš„ç³»ç»Ÿæƒé™
- é‡å¯åº”ç”¨æˆ–é‡æ–°å®‰è£…

### 3. æ´»åŠ¨è¯†åˆ«ä¸å‡†ç¡®
```java
// è°ƒæ•´è¯†åˆ«å‚æ•°
ActivityRecognizer recognizer = new ActivityRecognizer(this);
// å¯ä»¥ä¿®æ”¹é˜ˆå€¼å‚æ•°æ¥æé«˜å‡†ç¡®æ€§
```

### 4. æ•°æ®å­˜å‚¨ç©ºé—´ä¸è¶³
```java
public void cleanupOldData() {
    File dataDir = getExternalFilesDir(null);
    long cutoffTime = System.currentTimeMillis() - (7 * 24 * 60 * 60 * 1000); // 7å¤©å‰
    
    File[] files = dataDir.listFiles();
    for (File file : files) {
        if (file.lastModified() < cutoffTime) {
            file.delete();
        }
    }
}
```

## ğŸ“ˆ **æ€§èƒ½ä¼˜åŒ–**

### 1. å†…å­˜ä¼˜åŒ–
```java
// å®šæœŸæ¸…ç†å†…å­˜ä¸­çš„æ•°æ®é˜Ÿåˆ—
screenCollector.clearQueue();

// é™åˆ¶æ•°æ®æ”¶é›†é¢‘ç‡
collector.setCollectionInterval(60000); // 1åˆ†é’Ÿé—´éš”
```

### 2. ç”µæ± ä¼˜åŒ–
```java
// åœ¨å±å¹•å…³é—­æ—¶æš‚åœæ”¶é›†
@Override
protected void onPause() {
    super.onPause();
    collector.pauseCollection();
}

@Override
protected void onResume() {
    super.onResume();
    collector.resumeCollection();
}
```

## ğŸ“ **æŠ€æœ¯æ”¯æŒ**

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼š`adb logcat | grep DataCollector`
2. æ£€æŸ¥æƒé™è®¾ç½®
3. ç¡®è®¤è®¾å¤‡å…¼å®¹æ€§
4. é‡æ–°å®‰è£…åº”ç”¨

## ğŸ”„ **æ›´æ–°å’Œç»´æŠ¤**

å®šæœŸæ›´æ–°åº”ç”¨ä»¥è·å¾—ï¼š
- æ–°åŠŸèƒ½æ”¯æŒ
- æ€§èƒ½ä¼˜åŒ–
- å®‰å…¨è¡¥ä¸
- å…¼å®¹æ€§æ”¹è¿›

---

**æ³¨æ„**: ä½¿ç”¨æœ¬åº”ç”¨å‰è¯·ç¡®ä¿å·²è·å¾—ç”¨æˆ·æ˜ç¡®åŒæ„ï¼Œå¹¶éµå®ˆå½“åœ°éšç§æ³•è§„ã€‚ 